# Документация сети

Вся сеть должна быть строго документирована: от принципиальной схемы, до имени интерфейса.  
Прежде, чем приступить к настройке, я бы хотел привести список необходимых документов и действий:

* **Схемы сети L1, L2, L3 в соответствии с уровнями модели OSI \(Физический, канальный, сетевой\)**
* **План IP-адресации = IP-план**
* **Список VLAN**
* **Подписи \(description\) интерфейсов**
* Список устройств \(для каждого следует указать: модель железки, установленная версия IOS, объем RAM\NVRAM, список интерфейсов\)
* Метки на кабелях \(откуда и куда идёт\), в том числе на кабелях питания и заземления и устройствах
* Единый регламент, определяющий все вышеприведённые параметры и другие

Жирным выделено то, за чем мы будем следить в рамках программы-симулятора. Разумеется, все изменения сети нужно вносить в документацию и конфигурацию, чтобы они были в актуальном состоянии.

Говоря о метках/наклейках на кабели, мы имеем ввиду это:  
![Метки на кабелях](http://img-fotki.yandex.ru/get/4008/ait-it.1/0_41ccf_cebcb444_L.jpg)

На этой фотографии отлично видно, что промаркирован каждый кабель, значение каждого автомата на щитке в стойке, а также каждое устройство.

![](http://img-fotki.yandex.ru/get/4111/ait-it.1/0_41ccd_70990884_L.jpg "Метки на кабелях")

Подготовим нужные нам документы:

###### Список VLAN

| № VLAN | VLAN name | Примечание |
| :--- | :--- | :--- |
| 1 | default | Не используется |
| 2 | Management | Для управления устройствами |
| 3 | Servers | Для серверной фермы |
| 4-100 |  | Зарезервировано |
| 101 | PTO | Для пользователей ПТО |
| 102 | FEO | Для пользователей ФЭО |
| 103 | Accounting | Для пользователей Бухгалтерии |
| 104 | Other | Для других пользователей |

Каждая группа будет выделена в отдельный влан. Таким образом мы ограничим широковещательные домены. Также введём специальный VLAN для управления устройствами.

Номера VLAN c 4 по 100 зарезервированы для будущих нужд.

###### IP-план

| IP-адрес | Примечание | VLAN |
| :--- | :--- | :--- |
| **172.16.0.0/16** |  |  |
| **172.16.0.0/24** | Серверная ферма | 3 |
| 172.16.0.1 | Шлюз |  |
| 172.16.0.2 | Web |  |
| 172.16.0.3 | File |  |
| 172.16.0.4 | Mail |  |
| 172.16.0.5 — 172.16.0.254 | Зарезервировано |  |
| **172.16.1.0/24** | Управление | 2 |
| 172.16.1.1 | Шлюз |  |
| 172.16.1.2 | msk-arbat-dsw1 |  |
| 172.16.1.3 | msk-arbat-asw1 |  |
| 172.16.1.4 | msk-arbat-asw2 |  |
| 172.16.1.5 | msk-arbat-asw3 |  |
| 172.16.1.6 | msk-rubl-aswl |  |
| 172.16.1.6 — 172.16.1.254 | Зарезервировано |  |
| **172.16.2.0/24** | Сеть Point-to-Point |  |
| 172.16.2.1 | Шлюз |  |
| 172.16.2.2 — 172.16.2.254 | Зарезервировано |  |
| **172.16.3.0/24** | ПТО | 101 |
| 172.16.3.1 | Шлюз |  |
| 172.16.3.2 — 172.16.3.254 | Пул для пользователей |  |
| **172.16.4.0/24** | ФЭО | 102 |
| 172.16.4.1 | Шлюз |  |
| 172.16.4.2 — 172.16.4.254 | Пул для пользователей |  |
| **172.16.5.0/24** | Бухгалтерия | 103 |
| 172.16.5.1 | Шлюз |  |
| 172.16.5.2 — 172.16.5.254 | Пул для пользователей |  |
| **172.16.6.0/24** | Другие пользователи | 104 |
| 172.16.6.1 | Шлюз |  |
| 172.16.6.2 — 172.16.6.254 | Пул для пользователей |  |

Выделение подсетей в общем-то произвольное, соответствующее только числу узлов в этой локальной сети с учётом возможного роста. В данном примере все подсети имеют стандартную маску /24 \(/24=255.255.255.0\) — зачастую такие и используются в локальных сетях, но далеко не всегда. Советуем почитать о [классах сетей](http://ru.wikipedia.org/wiki/Классовая_адресация). В дальнейшем мы обратимся и к [бесклассовой адресации](http://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing) \([cisco](http://www.cisco.com/en/US/tech/tk365/technologies_tech_note09186a00800a67f5.shtml)\). Мы понимаем, что ссылки на технические статьи в википедии — это моветон, однако они дают хорошее определение, а мы попробуем в свою очередь перенести это на картину реального мира.

Под сетью Point-to-Point подразумеваем подключение одного маршрутизатора к другому в режиме точка-точка. Обычно берутся адреса с маской 30 \(возвращаясь к теме бесклассовых сетей\), то есть содержащие два адреса узла. Позже станет понятно, о чём идёт речь.

###### План подключения оборудования по портам

Разумеется, сейчас есть коммутаторы с кучей портов 1Gb Ethernet, есть коммутаторы с 10G, на продвинутых операторских железках, стоящих немалые тысячи долларов есть 40Gb, 100Gb. Соответственно, вы можете выбирать в реальном мире коммутаторы и маршрутизаторы согласно вашим потребностям, не забывая про бюджет. В частности гигабитный свич сейчас можно купить незадорого \(20-30 тысяч\) и это с запасом на будущее \(если вы не провайдер, конечно\). Маршрутизатор с гигабитными портами стоит уже ощутимо дороже, чем со 100Mbps портами, однако оно того стоит, потому что FE-модели \(100Mbps FastEthernet\), устарели и их пропускная способность очень невысока.

Но в программах эмуляторах/симуляторах, которые мы будем использовать, к сожалению, есть только простенькие модели оборудования, поэтому при моделировании сети будем отталкиваться от того, что имеем: маршрутизатор cisco2811, коммутаторы cisco2960 и 2950.

| Имя устройства | Порт | Название  | VLAN, Access | VLAN, Trunk |
| :--- | :--- | :--- | :--- | :--- |
| msk-arbat-gw1 | FE0/1 | UpLink |  |  |
|  | FE0/0 | msk-arbat-dsw1 |  | 2,3,101,102,103,104 |
| msk-arbat-dsw1 | FE0/24 | msk-arbat-gw1 |  | 2,3,101,102,103,104 |
|  | GE1/1 | msk-arbat-asw1 |  | 2,3 |
|  | GE1/2 | msk-arbat-asw3 |  | 2,101,102,103,104 |
|  |  | FE0/1 | msk-rubl-asw1 | 2,101,104 |
| msk-arbat-asw1 | GE1/1 | msk-arbat-dsw1 |  | 2,3 |
|  | GE1/2 | msk-arbat-asw2 |  | 2,3 |
|  | FE0/1 | Web-server | 3 |  |
|  | FE0/2 | File-server | 3 |  |
| msk-arbat-asw2 | GE1/1 | msk-arbat-asw1 |  | 2,3 |
|  | FE0/1 | Mail-Server | 3 |  |
| msk-arbat-asw3 | GE1/1 | msk-arbat-dsw1 |  | 2,101,102,103,104 |
|  | FE0/1-FE0/5 | PTO | 101 |  |
|  | FE0/6-FE0/10 | FEO | 102 |  |
|  | FE0/11-FE0/15 | Accounting | 103 |  |
|  | FE0/16-FE0/24 | Other | 104 |  |
| msk-rubl-asw1 | FE0/24 | msk-arbat-dsw1 | 1 | 2,101,104 |
|  | FE0/1-FE0/15 | PTO | 101 |  |
|  | FE0/20 | administrator | 104 |  |

  
Почему именно так распределены VLAN'ы, мы объясним в следующих частях.

[Excel-документ со списком VLAN, IP, портов](https://docs.google.com/spreadsheet/pub?key=0AooexOHebRpTdGotdEN6QVNsbWpHZ2xHdFA1elJBOGc&output=html)

##### Схемы сети

На основании этих данных можно составить все три схемы сети на этом этапе. Для этого можно воспользоваться Microsoft Visio, каким-либо бесплатным приложением, но с привязкой к своему формату, или редакторами графики \(можно и от руки, но это будет сложно держать в актуальном состоянии :\)\).

Не пропаганды опен сорса для, а разнообразия средств ради, воспользуемся Dia. Я считаю его одним из лучших приложений для работы со схемами под Linux. Есть версия для Виндоус, но, к сожалению, совместимости в визио никакой.

###### L1

![](http://img-fotki.yandex.ru/get/3417/83739833.f/0_7c0ae_99288497_XL.jpg "Схема сети L1")

То есть на схеме L1 мы отражаем физические устройства сети с номерами портов: что куда подключено.

###### L2

На схеме L2 мы указываем наши VLAN’ы

![](http://img-fotki.yandex.ru/get/5823/83739833.f/0_7bc12_58e09f6b_XL.jpg "Схема сети L2")

###### L3

![](http://img-fotki.yandex.ru/get/5823/83739833.f/0_7bc15_3c12c02c_XL.jpg "Схема сети L3")

  
В нашем примере схема третьего уровня получилась довольно бесполезная и не очень наглядная, из-за наличия только одного маршрутизирующего устройства. Но со временем она обрастёт подробностями.  
Dia-файлы со схемами сети:

[L1](https://yadi.sk/d/wkLLZ3R93GPeZz), [L2](https://yadi.sk/d/k6jeksaI3GPea7), [L3](https://yadi.sk/d/bo_N8vPg3GPeaF)

Как видите, информация в документах избыточна. Например, номера VLAN повторяются и на схеме и в плане по портам. Тут как бы кто на что горазд. Как вам удобнее, так и делайте. Такая избыточность затрудняет обновление в случае изменения конфигурации, потому что нужно исправиться сразу в нескольких местах, но с другой стороны, облегчает понимание.

К этой первой статье мы не раз ещё вернёмся в будущем, равно как и вам придётся всегда возвращаться к тому, что вы изначально напланировали.

Собственно задание для тех, кто пока только начинает учиться и готов приложить для этого усилия: много читать про вланы, ip-адресацию, найти программы Packet Tracer и GNS3.

Что касается фундаментальных теоретических знаний, то советуем начать читать Cisco press. Это то, что вам совершенно точно понадобится знать.

В следующей части всё будет уже по-взрослому, с видео, мы будем учиться подключаться к оборудованию, разбираться с интерфейсом и расскажем, что делать нерадивому админу, забывшему пароль.  
P.S. Спасибо соавтору статьи — Максиму aka gluck.

P.P.S Тем, кто имеет, что спросить, но не имеет возможности свой вопрос здесь задать, милости просим в

[ЖЖ](http://eucariot.livejournal.com/54958.html)

